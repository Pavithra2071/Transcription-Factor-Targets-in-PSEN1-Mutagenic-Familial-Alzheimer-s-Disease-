# Load required libraries
library(DESeq2)
library(ggplot2)
library(ggrepel)

# Step 1: Load raw count data and metadata for Dataset 1 and Dataset 2

# Replace with your file paths
raw_counts_1 <- read.csv("C:/path/to/your/raw_counts_1.csv", row.names = 1)  # Dataset 1
metadata_1 <- read.csv("C:/path/to/your/metadata_1.csv", row.names = 1)  # Metadata for Dataset 1

raw_counts_2 <- read.csv("C:/path/to/your/raw_counts_2.csv", row.names = 1)  # Dataset 2
metadata_2 <- read.csv("C:/path/to/your/metadata_2.csv", row.names = 1)  # Metadata for Dataset 2

# Step 2: Create DESeqDataSets for both datasets
dds_1 <- DESeqDataSetFromMatrix(countData = raw_counts_1, colData = metadata_1, design = ~ condition)
dds_2 <- DESeqDataSetFromMatrix(countData = raw_counts_2, colData = metadata_2, design = ~ condition)

# Step 3: Run DESeq2 on both datasets
dds_1 <- DESeq(dds_1)
dds_2 <- DESeq(dds_2)

# Step 4: Obtain DESeq2 results for both datasets
DESeq2_results1 <- results(dds_1)
DESeq2_results2 <- results(dds_2)

# Step 5: Add a column to each result to distinguish the datasets
DESeq2_results1$dataset <- "Dataset 1"
DESeq2_results2$dataset <- "Dataset 2"

# Step 6: Combine the results from both datasets
combined_results <- rbind(as.data.frame(DESeq2_results1), as.data.frame(DESeq2_results2))
