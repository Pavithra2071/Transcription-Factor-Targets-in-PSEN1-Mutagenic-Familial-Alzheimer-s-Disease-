# Convert gene symbols to Entrez IDs
entrez_ids <- bitr(rownames(res), fromType="SYMBOL", toType="ENTREZID", OrgDb=org.Hs.eg.db)
res$ENTREZID <- entrez_ids$ENTREZID[match(rownames(res), entrez_ids$SYMBOL)]
write.csv(res, "DEG_results_with_entrez.csv")

# Perform KEGG pathway enrichment
kegg_results <- enrichKEGG(gene = na.omit(res$ENTREZID), organism = "hsa", keyType = "kegg")
write.csv(as.data.frame(kegg_results), "KEGG_enrichment_results.csv")

# Visualizing KEGG pathways
pathway_id <- "hsa05010"  # Alzheimer's disease pathway
pathview(gene.data = res$log2FoldChange, pathway.id = pathway_id, species = "hsa", out.suffix = "Alzheimers")
